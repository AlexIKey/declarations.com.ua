{% extends "base.jinja" %}

{% block extrahead %}
{% if results.has_previous() %}<link rel="prev" href="?{{ updated_querystring(request, {'page': results.previous_page_number()}) }}" />{% endif %}
{% if results.has_next() %}<link rel="next" href="?{{ updated_querystring(request, {'page': results.next_page_number()}) }}" />{% endif %}
{% endblock %}

{% block html_desc %}{% if meta %}{{ meta.description }}{% else %}{{ super() }}{% endif %}{% endblock %}
{% block html_title %}{% if meta %}{{ meta.title }}{% else %}{{ super() }}{% endif %}{% endblock %}

{% block bodyclass %}not-front search-page{% endblock %}

{% block content %}
<section id="page">
    <div class="container">
        <div id="breadcrumbs">
            <ol class="breadcrumb">
                <li><a href="{{ url("wagtail_serve", "") }}">Головна</a></li>
                <li class="active">Результати пошуку</li>
            </ol> 
        </div>
        <h1 id="page-header"><span>{{ query|default("Всі")|escape }} ({{ results.paginator.count }})</span>
        {{ social("Результати пошуку по: %s. " % query,
                  "http://declarations.com.ua%s" % request.path ,
                  add_disqus=False) }}
        </h1>
        <div class="page-content">
            <div class="btn-group">
                <a href="#" id="list" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-th-list"></span> Списком
                </a> 
                <a href="#" id="grid" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-th"></span> Картками
                </a>
            </div>
            <div id="search-results" class="row list-group">
                {% for r in results %}
                <div class="item col-sm-12  col-md-6 col-lg-4 grid-group-item{% if r.declaration.source == "CHESNO" %} chesno{% elif r.declaration.source == "NACP" %} nacp{% endif %}" itemscope itemtype="http://schema.org/Person">
                    <div class="box">
                        <h3>
                        {% if r.meta.id %}
                            <a href="{{ url("details", declaration_id=r.meta.id) }}" itemprop="name">{{ r.general.last_name }} {{ r.general.name }} {{ r.general.patronymic }}</a>
                        {% else %}
                            {{ r.general.last_name }} {{ r.general.name }} {{ r.general.patronymic }}
                        {% endif %}
                        </h3>
                        <ul class="tags_list">
                            <li class="type">
                                <span class="glyphicon glyphicon-tags" aria-hidden="true"></span>
                                {% if r.intro.declaration_year %}{{ r.intro.declaration_year }}<span>,</span>{% endif %}
                                {% if r.intro.doc_type %}{{ r.intro.doc_type }}<span>,</span>{% endif %}
                                {% if r.intro.corrected %}Уточнена <span>,</span>{% endif %}
                            </li>
                            {% if r.general.post.region %}
                                <li><a href="{{ url('region', region_name=r.general.post.region) }}">{{ r.general.post.region }}</a><span>,</span></li> 
                            {% endif %}
                            {% if r.general.post.office %}
                                <li><a href="{{ url('office', office_name=r.general.post.office) }}">{{ r.general.post.office }}</a><span>,</span></li> 
                            {% endif %}
                            {% if r.general.post.post %}
                                <li itemprop="jobTitle">{{ r.general.post.post }}</li> 
                            {% endif %}
                            {% if r.intro.date %}
                                <li class="date"><span class="glyphicon glyphicon-calendar"></span> подана {{ r.intro.date|date }}</li>
                            {% endif %}
                        </ul>
                    </div>
                </div>

                {% endfor %}
            </div>
            {% if results.paginator.num_pages > 1 %}
            <ul class="pagination">
                <li{% if not results.has_previous() %} class="disabled"{% endif %}><a href="{% if results.has_previous() %}?{{ updated_querystring(request, {'page': results.previous_page_number()}) }}{% endif %}">«</a></li>
                {% for page_num in results.contextual_page_range %}
                {% if page_num == None %}
                    <li class="disabled"><a href="#">&hellip;</a></li>
                {% else %}
                    <li{% if results.number == page_num %} class="active"{% endif %}><a href="?{{ updated_querystring(request, {'page': page_num}) }}">{{ page_num }}</a></li>
                {% endif %}
                {% endfor %}
                <li{% if not results.has_next() %} class="disabled"{% endif %}><a href="{% if results.has_next() %}?{{ updated_querystring(request, {'page': results.next_page_number()}) }}{% endif %}">»</a></li>
            </ul>
            {% endif %}
    </div>
</section>

{% endblock %}